/* Implicit Cursor - %found */ 


DECLARE
  v_rows_updated NUMBER;
BEGIN
  -- Update the status of inactive accounts
  UPDATE accounts
  SET status = 'active'
  WHERE last_transaction_date < SYSDATE - 365;

  -- Get the number of rows affected by the update
  v_rows_updated := SQL%ROWCOUNT;

  -- Display message based on the number of rows updated
  IF v_rows_updated > 0 THEN
    DBMS_OUTPUT.PUT_LINE(v_rows_updated || ' accounts have been activated');
  ELSE
    DBMS_OUTPUT.PUT_LINE('No inactive accounts found');
  END IF;
EXCEPTION
  WHEN OTHERS THEN
    -- Handle any exceptions
    DBMS_OUTPUT.PUT_LINE('An error occurred');
END;
/


/* Explicit cursor - Attendence */ 

DECLARE
  CURSOR c_students IS
    SELECT roll, att
    FROM stud21
    WHERE att < 75;
BEGIN
  FOR rec IN c_students LOOP
    -- Update the status of the student to 'D' in the stud21 table
    UPDATE stud21
    SET status = 'D'
    WHERE roll = rec.roll;

    -- Insert a record into the d_stud table for the detained student
    INSERT INTO d_stud (roll, att)
    VALUES (rec.roll, rec.att);
  END LOOP;

  -- Commit the changes
  COMMIT;

  -- Display a message indicating the number of students detained
  DBMS_OUTPUT.PUT_LINE('Detained students: ' || c_students%ROWCOUNT);
EXCEPTION
  WHEN OTHERS THEN
    -- Rollback the changes in case of any error
    ROLLBACK;
    DBMS_OUTPUT.PUT_LINE('An error occurred: ' || SQLERRM);
END;
/






